/* global $:true */
/* jshint unused:false*/
+function(e){"use strict";var s;e.fn.cityPicker=function(a){return a=e.extend({},s,a),this.each(function(){var s=function(e){for(var s=[],a=0;a<e.length;a++){var t=e[a];"请选择"!==t.name&&s.push(t.name)}return s.length?s:[""]},t=function(e){return e.sub?s(e.sub):[""]},l=function(e){for(var s=0;s<r.length;s++)if(r[s].name===e)return t(r[s]);return[""]},u=function(e,s){for(var a=0;a<r.length;a++)if(r[a].name===e)for(var l=0;l<r[a].sub.length;l++)if(r[a].sub[l].name===s)return t(r[a].sub[l]);return[""]},r=e.rawCitiesData,n=r.map(function(e){return e.name}),c=t(r[0]),i=t(r[0].sub[0]),o=n[0],v=c[0],f=i[0],h=[{values:n,cssClass:"col-province"},{values:c,cssClass:"col-city"}];a.showDistrict&&h.push({values:i,cssClass:"col-district"});var p=null;a.onChange&&(p=a.onChange,delete a.onChange);var g={cssClass:"city-picker",rotateEffect:!1,onChange:function(e,s,t){var r,n=e.cols[0].value;if(n!==o){var c=l(n);r=c[0];var i=u(n,r);return e.cols[1].replaceValues(c),a.showDistrict&&e.cols[2].replaceValues(i),o=n,v=r,void e.updateValue()}a.showDistrict&&(r=e.cols[1].value,r!==v&&(e.cols[2].replaceValues(u(n,r)),v=r,e.updateValue())),p&&p(e,s,t)},cols:h};if(this){var C=e.extend(g,a),d=e(this).val();d&&(C.value=d.split(" "),C.value[0]&&(o=C.value[0],C.cols[1].values=l(C.value[0])),C.value[1]?(v=C.value[1],a.showDistrict&&(C.cols[2].values=u(C.value[0],C.value[1]))):(f=C.value[2],a.showDistrict&&(C.cols[2].values=u(C.value[0],C.cols[1].values[0])))),e(this).picker(C)}})},s=e.fn.cityPicker.prototype.defaults={showDistrict:!0}}($);