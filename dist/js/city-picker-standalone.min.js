/* global $:true */
/* jshint unused:false*/
+function(e){"use strict";var a;e.fn.cityPicker=function(s){return s=e.extend({},a,s),this.each(function(){var a=function(e){for(var a=[],s=0;s<e.length;s++){var t=e[s];"请选择"!==t.name&&a.push(t.name)}return a.length?a:[""]},t=function(e){return e.sub?a(e.sub):[""]},u=function(e){for(var a=0;a<r.length;a++)if(r[a].name===e)return t(r[a]);return[""]},l=function(e,a){for(var s=0;s<r.length;s++)if(r[s].name===e)for(var u=0;u<r[s].sub.length;u++)if(r[s].sub[u].name===a)return t(r[s].sub[u]);return[""]},r=e.rawCitiesData||window.weuiRawCitiesData,n=r.map(function(e){return e.name}),i=t(r[0]),c=t(r[0].sub[0]),o=n[0],v=i[0],f=c[0],h=[{values:n,cssClass:"col-province"},{values:i,cssClass:"col-city"}];s.showDistrict&&h.push({values:c,cssClass:"col-district"});var p=null;s.onChange&&(p=s.onChange,delete s.onChange);var w={cssClass:"city-picker",rotateEffect:!1,onChange:function(e,a,t){var r,n=e.cols[0].value;if(n!==o){var i=u(n);r=i[0];var c=l(n,r);return e.cols[1].replaceValues(i),s.showDistrict&&e.cols[2].replaceValues(c),o=n,v=r,void e.updateValue()}s.showDistrict&&(r=e.cols[1].value,r!==v&&(e.cols[2].replaceValues(l(n,r)),v=r,e.updateValue())),p&&p(e,a,t)},cols:h};if(this){var C=e.extend(w,s),d=e(this).val();d&&(C.value=d.split(" "),C.value[0]&&(o=C.value[0],C.cols[1].values=u(C.value[0])),C.value[1]?(v=C.value[1],s.showDistrict&&(C.cols[2].values=l(C.value[0],C.value[1]))):(f=C.value[2],s.showDistrict&&(C.cols[2].values=l(C.value[0],C.cols[1].values[0])))),e(this).picker(C)}})},a=e.fn.cityPicker.prototype.defaults={showDistrict:!0}}($);